
<!DOCTYPE html>
<html>
<head>
    <title>你是哪位股神？</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="MobileOptimized" content="320">
    <meta name="HandheldFriendly" content="True">
    <link href="css/doubi.css" rel="stylesheet">
    <link href="css/com.css?v=29" rel="stylesheet">
    <script src="js/jquery.min.js"></script>

</head>
<body>

<div id="index" class="main">
    <div id="index-head">
        <img src="img/巴菲特3.jpg">
    </div>
    <div id="index-start">
        <a id="js-start"><img src="./img/102512_9588.png"></a>
    </div>
</div>

<div id="q" class="main">
    <div class="q-box">

        <div id="q0" class="circle">
            <div class="detail">
                <div class="q-title">1984年，我国发行了改革开放后的第一支股票，它叫</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 飞乐音响</a></li>
                    <li><a href="javascript:void(0);">B. 申华实业</a></li>
                    <li><a href="javascript:void(0);">C. 深发展</a></li>
                    <li><a href="javascript:void(0);">D. 界龙实业</a></li>
                </ul>
            </div>
        </div>

        <div id="q1" class="circle">
            <div class="detail">
                <div class="q-title">1999年"5.19行情"的主要推动力是什么？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 国企改制大规模展开，需要股市资金</a></li>
                    <li><a href="javascript:void(0);">B. 海外市场互联网热潮的传导效应</a></li>
                    <li><a href="javascript:void(0);">C. 路透社公布了中国"政策市"的内部文件</a></li>
                    <li><a href="javascript:void(0);">D. 以上都是(>_<)o</a></li>
                </ul>
            </div>
        </div>

        <div id="q2" class="circle">
            <div class="detail">
                <div class="q-title">2001年A股第一支退市公司是？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. ST钢管</a></li>
                    <li><a href="javascript:void(0);">B. ST金田</a></li>
                    <li><a href="javascript:void(0);">C. PT水仙</a></li>
                    <li><a href="javascript:void(0);">D. PT振新</a></li>
                </ul>
            </div>
        </div>

        <div id="q3" class="circle">
            <div class="detail">
                <div class="q-title">2005年-2007年大盘从998涨到6124， 不是因为？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 股权分置改革，即常说的股改（国家股、法人股不允许交易）</a></li>
                    <li><a href="javascript:void(0);">B. 中国股市进入全流通时代</a></li>
                    <li><a href="javascript:void(0);">C. 价值回归</a></li>
                    <li><a href="javascript:void(0);">D. 提高印花税</a></li>
                </ul>
            </div>
        </div>

        <div id="q4" class="circle">
            <div class="detail">
                <div class="q-title">07年-08年大盘从6124一路下跌到1664，主要因为？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 受限流通股大量解禁</a></li>
                    <li><a href="javascript:void(0);">B. 全球金融危机</a></li>
                    <li><a href="javascript:void(0);">C. 货币政策收紧</a></li>
                    <li><a href="javascript:void(0);">D. 以上都是</a></li>
                </ul>
            </div>
        </div>

        <div id="q5" class="circle">
            <div class="detail">
                <div class="q-title">下面哪个创业板股票的老板跑路了？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 网宿科技</a></li>
                    <li><a href="javascript:void(0);">B. 乐视网</a></li>
                    <li><a href="javascript:void(0);">C. 蓝思科技</a></li>
                    <li><a href="javascript:void(0);">D. 昆仑万维</a></li>
                </ul>
            </div>
        </div>

        <div id="q6" class="circle">
            <div class="detail">
                <div class="q-title">融资融券的门槛是多少？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 资产达50万元、开户满12个月</a></li>
                    <li><a href="javascript:void(0);">B. 资产达30万元、开户满6个月</a></li>
                    <li><a href="javascript:void(0);">C. 资产达10万元、开户满6个月</a></li>
                    <li><a href="javascript:void(0);">D. 各个证券公司自己决定</a></li>
                </ul>
            </div>
        </div>

        <div id="q7" class="circle">
            <div class="detail">
                <div class="q-title">为什么08年到现在美股一路高歌猛进？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 经济情况转好</a></li>
                    <li><a href="javascript:void(0);">B. 量化宽松</a></li>
                    <li><a href="javascript:void(0);">C. 禁止裸卖空，空头大幅减少</a></li>
                    <li><a href="javascript:void(0);">D. 以上都是</a></li>
                </ul>
            </div>
        </div>

        <div id="q8" class="circle">
            <div class="detail">
                <div class="q-title">15年A股大牛市的驱动因素不包括？</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 热钱大量涌入</a></li>
                    <li><a href="javascript:void(0);">B. 政策刺激</a></li>
                    <li><a href="javascript:void(0);">C. 经济快速发展</a></li>
                    <li><a href="javascript:void(0);">D. 监管应对失误</a></li>
                </ul>
            </div>
        </div>

        <div id="q9" class="circle">
            <div class="detail">
                <div class="q-title">什么样的投资能保证稳赚不赔</div>
                <ul class="q-opt">
                    <li><a href="javascript:void(0);">A. 追涨杀跌</a></li>
                    <li><a href="javascript:void(0);">B. 看基本面</a></li>
                    <li><a href="javascript:void(0);">C. 听隔壁张大妈说内部消息</a></li>
                    <li><a href="javascript:void(0);">D. 矮马，你做梦啊</a></li>
                </ul>
            </div>
        </div>


        <ul id="progress">
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
            <li class="p-circle"><span><img src="./img/Ainvest.png"></span></li>
        </ul>
    </div>
</div>


<div id="r" class="main">
    <div class="box" id="bb">
        <canvas id="cas" ></canvas>
    </div>
    <img src="./img/巴菲特2.jpg">
    <div id="share">
        <a id="s-wx" ></a>
        <a id="s-wb" ></a>
        <div class="clear"></div>
    </div>
</div>


<script type="text/javascript">
    $(function() {
        var w=$(".main").width();
        var h=$(".main").height();
        var q=0; //题目序号

        var resultImgs = [
            "./img/刘芳.jpg",
            "./img/巴菲特.jpg",
            "./img/彼得林奇.jpg",
            "./img/杨百万.jpg",
            "./img/林园.jpg",
            "./img/王亚伟.jpg",
            "./img/索罗斯.jpg",
            "./img/洗洗睡吧.jpg"
        ];

        var iconImgs = [
            "./img/110735_2206.jpg",
            "./img/110825_8617.jpg",
            "./img/110844_8493.jpg",
            "./img/110911_6812.jpg",
            "./img/110928_8792.jpg",
            "./img/110943_5302.jpg",
            "./img/110958_1612.jpg",
            "./img/111409_9332.jpg"
        ];

        var shareLink = window.location.href;

        var dataForWeixin = {
            appId: "",
            img: iconImgs[0],
            url: shareLink,
            title: '我是【巴菲特】型股神，这个钱我赚定了！你们不要跟我抢 ',
            desc: '我是【巴菲特】型股神，这个钱我赚定了！你们不要跟我抢 ',
            fakeid: ""
        };
        (function() {
            var onBridgeReady = function() {

                WeixinJSBridge.on('menu:share:appmessage', function(argv) {
                    WeixinJSBridge.invoke('sendAppMessage', {

                    }, function(res) {

                    });
                });

                WeixinJSBridge.on('menu:share:timeline', function(argv) {
                    WeixinJSBridge.invoke('shareTimeline', {

                    }, function(res) {

                    });
                });

                WeixinJSBridge.on('menu:share:weibo', function(argv) {
                    WeixinJSBridge.invoke('shareWeibo', {

                    }, function(res) {

                    });
                });

                WeixinJSBridge.on('menu:share:facebook', function(argv) {
                    WeixinJSBridge.invoke('shareFB', {

                    }, function(res) {

                    });
                });
            };
            if (document.addEventListener) {
                document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
            } else if (document.attachEvent) {
                document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
                document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
            }
        })();

        //撑满屏幕
        $("#index,#r").css("min-height",$(window).height());
        //$("#cas").attr("width",w).attr("height",h);
        $(".q-box").css("min-height",$(window).height()*0.85);

        //定义圆形
        //$(".circle").width(w*0.78).height(w*0.78).css({"border-radius":w*0.39});
        //$(".detail").css({padding:w*0.14});

        //开始按钮
        $("#js-start").click(function(){
            $("#index").hide();
            $("#q").show();
            q=0;
            $("#q0").show();
            $(".p-circle").eq(q).find("img").show();
        });

        //点击答题选项
        $(".q-opt li").click(function(){
            $(this).css({background:"#f00"});
            $("#q"+q).hide(1,function(){
                q++;
                if(q>9){
                    //序号大于9跳转结果
                    $("#q").hide();

                    var color=['ffd100','007fb1','ef3e33','49932a','007fb1','ef3e33','49932a','ffd100'];
                    var doubi=['杨百万','王亚伟','刘芳','索罗斯','巴菲特','林园','彼得·林奇','洗洗睡吧'];
                    var rand=Math.floor(Math.random()*(color.length));

                    $("#r").css("background-color","#"+color[rand]);
                    $("#r img").attr("src", resultImgs[rand]);
                    dataForWeixin.img=iconImgs[rand];
                    dataForWeixin.title=dataForWeixin.desc="我是【"+doubi[rand]+"】型股神，这个钱我赚定了！你们不要跟我抢 ";
                    if(rand==7){
                        dataForWeixin.title=dataForWeixin.desc="纳尼？！看来我注定与股神无缘，洗洗睡吧！";
                        $("#bb").show();

                        // 蒙板插件
                        var node = $('#bb')[0],
                                url = resultImgs[7],
                                canvas_url = 'img/canvas.jpg',
                                type = 'image',
                                w = 640,
                                h = $(window).height(),
                                callback = function(){$("#bb").hide();return false;};

                        cover_draw(node,url,canvas_url,type,w,h,callback);
                    }
                    var wbImg=iconImgs[rand];
                    //  $("#s-wb").attr("href","http://service.weibo.com/share/share.php?title="+dataForWeixin.title+"&url="+ shareLink +"&appkey=&pic="+wbImg);

                    $("#r").show();
                }else{
                    $("#q"+q).show();
                    $(".p-circle").eq(q).find("img").show();
                }
            });
        });



    });

    // 蒙板插件初始化函数处理
    function cover_draw(node,url,canvas_url,type,w,h,callback){
        if(node.style.display.indexOf('none')>-1) return;

        var lottery = new Lottery(node, canvas_url, type, w, h, callback);
        lottery.init();
    }


    /**
     *  canvas蒙板图片处理插件
     *  -----------------------------
     *  作者：叼怎么写！- -||
     *  时间：2014-03-21
     *  准则：JS原型
     *  联系：wechat--shoe11414255
     *  一张网页，要经历怎样的过程，才能抵达用户面前
     *  一个特效，要经历这样的修改，才能让用户点个赞
     *  一个产品，创意源于生活，源于内心，需要慢慢品味
     *********************************************************************************************
     *  这是别人写的东西，我只是重复利用，微调了下--努力努力 ^-^||
     *
     * -----------保持队形------------------
     *  <div id='Lottery'></div>
     *********************************************************************************************/
    /**
     * [Lottery description]蒙板插件
     * @param  {DOM}      node       canvas对象父辈
     * @param  {地址值}    url        背景图片或者文字
     * @param  {地址值}    canvas_url 蒙板的图片
     * @param  {DOM类型}   type       蒙板的类型
     * @param  {px}       w          画布的宽度
     * @param  {px}       h          画布的高度
     * @param  {fn}       callback   回调函数
     */
    function Lottery(node, cover, coverType, width, height, drawPercentCallback) {
        //canvas
        this.conNode = node;

        // 背景canvas
        this.background = null;
        this.backCtx = null;

        // 蒙板canvas
        this.mask = null;
        this.maskCtx = null;

        // 背景图
        this.lottery = null;
        this.lotteryType = 'image';

        // 蒙板图
        this.cover = cover || "#000";
        this.coverType = coverType;
        this.pixlesData = null;

        // canvas宽高
        this.width = width;
        this.height = height;

        this.lastPosition = null;
        // 回调函数
        this.drawPercentCallback = drawPercentCallback;

        this.vail = false;
    }


    Lottery.prototype = {
        // 创建元素
        createElement: function (tagName, attributes) {
            var ele = document.createElement(tagName);
            for (var key in attributes) {
                ele.setAttribute(key, attributes[key]);
            }
            return ele;
        },

        // 获取当前canvas透明像素的百分比
        getTransparentPercent: function(ctx, width, height) {
            // 获取画布的像素点
            var imgData = ctx.getImageData(0, 0, width, height),
                    pixles = imgData.data,
                    transPixs = [];

            // 计算画布中，透明程度（第四个值为透明度0-255）
            for (var i = 0, j = pixles.length; i < j; i += 4) {
                var a = pixles[i + 3];
                if (a < 128) {
                    transPixs.push(i);
                }
            }
            return (transPixs.length / (pixles.length / 4) * 100).toFixed(2);
        },

        // 重置画布
        resizeCanvas: function (canvas, width, height) {
            canvas.width = width;
            canvas.height = height;
            canvas.getContext('2d').clearRect(0, 0, width, height);
        },

        resizeCanvas_w : function(canvas, width, height){
            canvas.width = width;
            canvas.height = height;
            canvas.getContext('2d').clearRect(0, 0, width, height);

            // canvas画布，生成对应的DOM开始--(前者判断是否生成背景图)
            if(this.vail) this.drawLottery();
            else this.drawMask();
        },

        // 画布上画点
        drawPoint: function (x, y, fresh) {
            this.maskCtx.beginPath();
            this.maskCtx.arc(x, y, 30, 0, Math.PI * 2);
            this.maskCtx.fill();

            // 蒙板-路径还是记录
            this.maskCtx.beginPath();

            // 画笔大小
            this.maskCtx.lineWidth = 60;
            // 前者是线的末端样式，后者是线连接处的样式---圆
            this.maskCtx.lineCap = this.maskCtx.lineJoin = 'round';

            // 画点
            if (this.lastPosition) {
                this.maskCtx.moveTo(this.lastPosition[0], this.lastPosition[1]);
            }
            this.maskCtx.lineTo(x, y);
            this.maskCtx.stroke();

            this.lastPosition = [x,y];

            this.mask.style.zIndex = (this.mask.style.zIndex == 20) ? 21 : 20;
        },

        // 事件处理
        bindEvent: function () {
            var _this = this;
            // 判断是否为移动端
            var device = (/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));
            var clickEvtName = device ? 'touchstart' : 'mousedown';
            var moveEvtName = device? 'touchmove': 'mousemove';
            if (!device) {
                var isMouseDown = false;
                _this.conNode.addEventListener('mouseup', function(e) {
                    e.preventDefault();

                    isMouseDown = false;
                    var per = _this.getTransparentPercent(_this.maskCtx, _this.width, _this.height);

                    if(per>=50){
                        // 执行回调函数
                        if(typeof(_this.drawPercentCallback)=='function') _this.drawPercentCallback();
                    }
                }, false);
            } else {
                _this.conNode.addEventListener("touchmove", function(e) {
                    if (isMouseDown) {
                        e.preventDefault();
                    }
                    if (e.cancelable) { e.preventDefault(); }else{window.event.returnValue = false;}
                }, false);
                _this.conNode.addEventListener('touchend', function(e) {
                    isMouseDown = false;
                    var per = _this.getTransparentPercent(_this.maskCtx, _this.width, _this.height);
                    if(per>=50){
                        // 执行回调函数
                        if(typeof(_this.drawPercentCallback)=='function') _this.drawPercentCallback();
                    }
                }, false);
            }

            // move事件来画点
            this.mask.addEventListener(clickEvtName, function (e) {
                e.preventDefault();

                // 记录开始move
                isMouseDown = true;

                var x = (device ? e.touches[0].pageX : e.pageX-$("#r").offset().left||e.x-$("#r").offset().left);
                var y = (device ? e.touches[0].pageY : e.pageY||e.y);

                // 画点
                _this.drawPoint(x, y,isMouseDown);
            }, false);

            this.mask.addEventListener(moveEvtName, function (e) {
                e.preventDefault();

                // 记录是否开始move
                if (!isMouseDown)  return false;
                e.preventDefault();

                var x = (device ? e.touches[0].pageX : e.pageX-$("#r").offset().left||e.x-$("#r").offset().left);
                var y = (device ? e.touches[0].pageY : e.pageY||e.y);

                // 画点
                _this.drawPoint(x, y,isMouseDown);
            }, false);
        },

        // 画背景图
        drawLottery: function () {
            if (this.lotteryType == 'image') {
                var image = new Image(),
                        _this = this;
                image.onload = function () {
                    this.width = _this.width;
                    this.height = _this.height;
                    _this.resizeCanvas(_this.background, _this.width, _this.height);
                    _this.backCtx.drawImage(this, 0, 0, _this.width, _this.height);
                    _this.drawMask();
                }
                image.src = this.lottery;
            } else if (this.lotteryType == 'text') {
                this.width = this.width;
                this.height = this.height;
                this.resizeCanvas(this.background, this.width, this.height);
                this.backCtx.save();
                this.backCtx.fillStyle = '#FFF';
                this.backCtx.fillRect(0, 0, this.width, this.height);
                this.backCtx.restore();
                this.backCtx.save();
                var fontSize = 30;
                this.backCtx.font = 'Bold ' + fontSize + 'px Arial';
                this.backCtx.textAlign = 'center';
                this.backCtx.fillStyle = '#F60';
                this.backCtx.fillText(this.lottery, this.width / 2, this.height / 2 + fontSize / 2);
                this.backCtx.restore();
                this.drawMask();
            }
        },

        // 画蒙板
        drawMask: function() {
            if (this.coverType == 'color') {
                this.maskCtx.fillStyle = this.cover;
                this.maskCtx.fillRect(0, 0, this.width, this.height);
                this.maskCtx.globalCompositeOperation = 'destination-out';
            } else if (this.coverType == 'image'){
                var image = new Image(),
                        _this = this;
                image.onload = function () {
                    _this.resizeCanvas(_this.mask, _this.width, _this.height);

                    var android = (/android/i.test(navigator.userAgent.toLowerCase()));

                    _this.maskCtx.globalAlpha=0.98;
                    // _this.maskCtx.drawImage(this, 0, 0,_this.width, _this.height);
                    _this.maskCtx.drawImage(this,0,0,this.width,this.height,0,0,_this.width,_this.height);

                    var fontSize = 50;
                    var txt = '';
                    var gradient=_this.maskCtx.createLinearGradient(0,0,_this.width,0);
                    gradient.addColorStop("0","#fff");
                    gradient.addColorStop("1.0","#000");

                    _this.maskCtx.font = 'Bold ' + fontSize + 'px Arial';
                    _this.maskCtx.textAlign = 'left';
                    _this.maskCtx.fillStyle = gradient;
                    _this.maskCtx.fillText(txt,_this.width/2-_this.maskCtx.measureText(txt).width/2, 100);

                    _this.maskCtx.globalAlpha=1;

                    _this.maskCtx.globalCompositeOperation = 'destination-out';
                }
                image.src = this.cover;
            }
        },

        // 函数初始化
        init: function (lottery, lotteryType) {
            // 判断是否传入背景图参数，并储存值
            // 生成背景图的DOM
            if(lottery){
                this.lottery = lottery;
                this.lottery.width = this.width;
                this.lottery.height = this.height;
                this.lotteryType = lotteryType || 'image';

                this.vail = true;
            }
            if(this.vail){
                this.background = this.background || this.createElement('canvas', {
                    style: 'position:fixed;left:50%;top:0;width:640px;margin-left:-320px;height:100%;background-color:transparent;'
                });
            }

            // 生成蒙板DOM
            this.mask = this.mask || this.createElement('canvas', {
                style: 'position:fixed;left:50%;top:0;width:640px;margin-left:-320px;height:100%;background-color:transparent;'
            });
            this.mask.style.zIndex = 20;

            // 将目标wrapDOM的HTML内容全部清空--(canvas-clear）
            if (!this.conNode.innerHTML.replace(/[\w\W]| /g, '')) {
                if(this.vail) this.conNode.appendChild(this.background);
                this.conNode.appendChild(this.mask);
                this.bindEvent();
            }
            if(this.vail) this.backCtx = this.backCtx || this.background.getContext('2d');
            this.maskCtx = this.maskCtx || this.mask.getContext('2d');

            // canvas画布，生成对应的DOM开始--(前者判断是否生成背景图)
            if(this.vail) this.drawLottery();
            else this.drawMask();

            var _this = this;
            window.addEventListener('resize',function(){
                // canvas宽高
                _this.width = document.documentElement.clientWidth;
                _this.height = document.documentElement.clientHeight;

                _this.resizeCanvas_w(_this.mask, _this.width, _this.height);
            },false);
        }
    }

</script>


</body>
</html>